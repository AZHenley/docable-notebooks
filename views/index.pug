block variables
doctype html
html
    head
        meta(charset="utf-8")
        link(rel="shortcut icon", href="/favicon.ico")
        meta(name="viewport", content="width=device-width, initial-scale=1, shrink-to-fit=no")
        link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css")
        script(type='text/javascript', src='https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js')
        meta(name="theme-color", content="#000000")
        title #{title}


    body
        block layout-content
        div.View
            h1.Banner Docable Notebook
            textarea#Notebook

            button.btn.btn-primary(type='submit') Run Docable Notebook
            input#input-file(type='file')

        script(type="text/javascript").
            var simplemde = new SimpleMDE({ 
                element: document.getElementById("Notebook"), 
                autofocus: true,
                autosave: {
                    enabled: true,
                    delay: 100,
                },
                forceSync: true,
                placeholder: "Type here...",
                tabSize: 4,
            });

            document.getElementById('input-file')
                .addEventListener('change', getFile)

            function getFile(event) {
                const input = event.target
                if ('files' in input && input.files.length > 0) {
                    readFileContent(input.files[0]).then(content => {
                        simplemde.value(content)
                    }).catch(error => console.log(error))
                };
            }

            function readFileContent(file) {
                const reader = new FileReader()
                return new Promise((resolve, reject) => {
                    reader.onload = event => resolve(event.target.result)
                    reader.onerror = error => reject(error)
                    reader.readAsText(file)
                })
            }
